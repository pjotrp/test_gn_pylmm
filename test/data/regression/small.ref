sys.path2: ['/export/local/users/wrk/izip/git/opensource/python/gn2/wqflask/wqflask/my_pylmm/pyLMM', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/matplotlib_venn-0.9-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/googlecl-0.9.14-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/gdata-2.0.18-py2.7.egg', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/my_pylmm/pyLMM', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/lib', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/home/zas1024/gene/wqflask/', '/home/danny/GeneNetwork/wqflask/wqflask/my_pylmm/pyLMM/']
Command:  redis
data/small.pheno
(5,)
data/small.geno
(6, 5)
Original G (6, 5) 
[[ 1.   1.   0.5  0.   1. ]
 [ 1.   1.   0.   0.   0. ]
 [ 0.   1.   0.5  0.   1. ]
 [ 1.   1.   0.   0.   0. ]
 [ 1.   1.   1.   0.   1. ]
 [ 1.   1.   0.5  0.   1. ]]
kinship_matrix
genotype_matrix
pheno_vector
covariate_matrix
pheno [ 0.578  0.196 -0.521 -1.912 -1.912]
geno (6, 5) [[ 1.   1.   0.5  0.   1. ]
 [ 1.   1.   0.   0.   0. ]
 [ 0.   1.   0.5  0.   1. ]
 [ 1.   1.   0.   0.   0. ]
 [ 1.   1.   1.   0.   1. ]
 [ 1.   1.   0.5  0.   1. ]]
Running the original LMM engine in run_other (old)
REML= True  REFIT= False
Starting benchmark: Calculate Kinship
G (6, 5) =
[ [ 1.   1.   0.5]  ...  [ 0.5  0.   1. ] 
  [ 1.  1.  0.]  ...  [ 0.  0.  0.] 
  ...
  [ 1.  1.  1.]  ...  [ 1.  0.  1.] 
  [ 1.   1.   0.5]  ...  [ 0.5  0.   1. ] ]
G (6, 5) =
[ [ 0.75  0.75 -0.5 ]  ...  [-0.5  -1.75  0.75] 
  [ 1.225  1.225 -0.816]  ...  [-0.816 -0.816 -0.816] 
  ...
  [ 0.5  0.5  0.5]  ...  [ 0.5 -2.   0.5] 
  [ 0.75  0.75 -0.5 ]  ...  [-0.5  -1.75  0.75] ]
  Calculate Kinship took: 0.016937 seconds
kinship_matrix:  array([[ 0.938,  0.521, -0.417, -0.729, -0.312],
       [ 0.521,  0.938, -0.417, -1.146,  0.104],
       [-0.417, -0.417,  0.347,  0.347,  0.139],
       [-0.729, -1.146,  0.347,  2.118, -0.59 ],
       [-0.312,  0.104,  0.139, -0.59 ,  0.66 ]])
kinship_matrix.shape:  (5, 5)
run_other_old genotype_matrix:  (6, 5)
[[ 0.75   0.75  -0.5   -1.75   0.75 ]
 [ 1.225  1.225 -0.816 -0.816 -0.816]
 [-1.118  1.118  0.    -1.118  1.118]
 [ 1.225  1.225 -0.816 -0.816 -0.816]
 [ 0.5    0.5    0.5   -2.     0.5  ]
 [ 0.75   0.75  -0.5   -1.75   0.75 ]]
Starting benchmark: Doing GWAS
this K is: (5, 5) array([[ 0.938,  0.521, -0.417, -0.729, -0.312],
       [ 0.521,  0.938, -0.417, -1.146,  0.104],
       [-0.417, -0.417,  0.347,  0.347,  0.139],
       [-0.729, -1.146,  0.347,  2.118, -0.59 ],
       [-0.312,  0.104,  0.139, -0.59 ,  0.66 ]])
Kva (5,) =
 [ 0.   0.1  0.3]  ...  [ 0.3    1.241  3.359]
Kve (5, 5) =
[ [ 0.447  0.203  0.535]  ...  [ 0.535  0.592  0.351] 
  [ 0.447 -0.263 -0.701]  ...  [-0.701  0.102  0.479] 
  ...
  [ 0.447  0.214 -0.277]  ...  [-0.277  0.295 -0.768] 
  [ 0.447  0.568  0.068]  ...  [ 0.068 -0.674  0.136] ]
sum(Kva),sum(Kve)= 5.0 [ 2.236  0.     0.     0.     0.   ]
self.Kva is:  (5,) array([ 0.   ,  0.1  ,  0.3  ,  1.241,  3.359])
self.Kve is:  (5, 5) array([[ 0.447,  0.203,  0.535,  0.592,  0.351],
       [ 0.447, -0.263, -0.701,  0.102,  0.479],
       [ 0.447, -0.722,  0.376, -0.314, -0.197],
       [ 0.447,  0.214, -0.277,  0.295, -0.768],
       [ 0.447,  0.568,  0.068, -0.674,  0.136]])
  Doing GWAS took: 0.027897 seconds

Timing report

[38%] Calculate Kinship: 0.0169370174408
[62%] Doing GWAS: 0.0278971195221

[ 0.739  0.161  0.653  0.161  0.398  0.739]
6 2.85063989558
