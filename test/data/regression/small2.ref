sys.path2: ['/export/local/users/wrk/izip/git/opensource/python/gn2/wqflask/wqflask/my_pylmm/pyLMM', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/matplotlib_venn-0.9-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/googlecl-0.9.14-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/gdata-2.0.18-py2.7.egg', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/my_pylmm/pyLMM', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/lib', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/home/zas1024/gene/wqflask/']
WARNING: Standalone version missing the Genenetwork2 environment

Command:  redis_new
data/small.pheno
(4,)
data/small.geno
(5, 4)
Original G (5, 4) 
[[ 1.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 0.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 1.   1.   1.   0. ]]
Loading Redis from parsed data
kinship None
pheno [ 0.57832646  0.19578235 -0.52130538 -1.91220117]
geno (4, 5) [[ 1.   1.   0.   1.   1. ]
 [ 1.   1.   1.   1.   1. ]
 [ 0.5  0.   0.5  0.   1. ]
 [ 0.   0.   0.   0.   0. ]]
Running the new LMM2 engine in run_other_new
REML= True  REFIT= False
Removed missing phenotypes (4,)
Starting benchmark: Calculate Kinship
call genotype.normalize
call calculate_kinship_new
CPU cores: 4
5 1000
  Calculate Kinship took: 0.008006 seconds
kinship_matrix:  array([[ 0.79393939,  0.35757576, -0.44242424, -0.70909091],
       [ 0.35757576,  1.08484848, -0.2969697 , -1.14545455],
       [-0.44242424, -0.2969697 ,  0.5030303 ,  0.23636364],
       [-0.70909091, -1.14545455,  0.23636364,  1.61818182]])
kinship_matrix.shape:  (4, 4)
run_other_new genotype_matrix:  (4, 5)
[[ 0.90453403  1.         -0.90453403  1.          0.57735027]
 [ 0.90453403  1.          1.50755672  1.          0.57735027]
 [-0.30151134 -1.          0.30151134 -1.          0.57735027]
 [-1.50755672 -1.         -0.90453403 -1.         -1.73205081]]
Starting benchmark: Doing GWAS
('this K is:', (4, 4), array([[ 0.79393939,  0.35757576, -0.44242424, -0.70909091],
       [ 0.35757576,  1.08484848, -0.2969697 , -1.14545455],
       [-0.44242424, -0.2969697 ,  0.5030303 ,  0.23636364],
       [-0.70909091, -1.14545455,  0.23636364,  1.61818182]]))
('Kva is: ', (4,), array([  3.33066905e-16,   3.36758563e-01,   7.31443118e-01,
         2.93179832e+00]))
('Kve is: ', (4, 4), array([[ 0.5       , -0.3911327 ,  0.67680568, -0.37275902],
       [ 0.5       ,  0.5755526 , -0.34000285, -0.55057903],
       [ 0.5       , -0.59158409, -0.5982933 ,  0.20511799],
       [ 0.5       ,  0.40716419,  0.26149047,  0.71822006]]))
('sum(Kva),sum(Kve)=', 4.0000009999999939, array([  2.00000000e+00,   4.99600361e-16,   1.72084569e-15,
         4.44089210e-16]))
Running on 1 THREAD
count= 5  running= 0  collect= 0
res= [(3.5568471719603592, 0.070757268360331388), (0.44037625284770371, 0.70268803640436173), (-0.34186399401465223, 0.76503338166652657), (0.44037625284770371, 0.70268803640436173), (2.3653606972218171, 0.14170723139969379)]
[5]
  Doing GWAS took: 0.026860 seconds

Timing report

[23%] Calculate Kinship: 0.00800609588623
[77%] Doing GWAS: 0.026859998703

[ 0.07075727  0.70268804  0.76503338  0.70268804  0.14170723]
5 2.38287395424
