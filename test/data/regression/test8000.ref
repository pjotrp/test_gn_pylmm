Command:  redis
data/test8000.pheno
(1219,)
data/test8000.geno
(8000, 1219)
{'noCUDA': False, 'testing': False, 'verbose': True, 'remove_missing_phenotypes': True, 'geno': 'data/test8000.geno', 'numThreads': None, 'maf_normalization': False, 'useBLAS': False, 'pheno': 'data/test8000.pheno', 'test_kinship': False, 'noBLAS': False, 'saveKvaKve': False, 'debug': False, 'genotype_normalization': False, 'kinship': None}
Original G (8000, 1219) 
[[ 0.  0.  0. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
Removed missing phenotypes (8000, 1217) 
[[ 0.  0.  0. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
geno (8000, 1217) =
[ [ 0.  0.  0.]  ...  [ 1.  1.  1.] 
  [ 1.  1.  1.]  ...  [ 1.  1.  1.] 
  ...
  [ 0.  0.  0.]  ...  [ 1.  1.  1.] 
  [ 0.  0.  0.]  ...  [ 0.  0.  0.] ] strides:  (8, 64000) 

pheno [ 0.578  0.196 -0.521 ..., -0.053 -1.052 -0.43 ]
geno (8000, 1217) [[ 0.  0.  0. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
Running the original LMM engine in run_other (old)
REML= True  REFIT= False
Starting benchmark: Calculate Kinship
G (8000, 1217) =
[ [ 0.  0.  0.]  ...  [ 1.  1.  1.] 
  [ 1.  1.  1.]  ...  [ 1.  1.  1.] 
  ...
  [ 0.  0.  0.]  ...  [ 1.  1.  1.] 
  [ 0.  0.  0.]  ...  [ 0.  0.  0.] ] strides:  (8, 64000) 

kinship_full K (1217, 1217) =
[ [ 1.435  1.435  1.435]  ...  [ 0.192  0.192  0.192] 
  [ 1.435  1.435  1.435]  ...  [ 0.192  0.192  0.192] 
  ...
  [ 0.192  0.192  0.192]  ...  [ 1.268  1.268  1.268] 
  [ 0.192  0.192  0.192]  ...  [ 1.268  1.268  1.268] ] strides:  (9736, 8) 

  Calculate Kinship took: 10.547848 seconds
kinship_matrix:  array([[ 1.435,  1.435,  1.435, ...,  0.192,  0.192,  0.192],
       [ 1.435,  1.435,  1.435, ...,  0.192,  0.192,  0.192],
       [ 1.435,  1.435,  1.435, ...,  0.192,  0.192,  0.192],
       ..., 
       [ 0.192,  0.192,  0.192, ...,  1.268,  1.268,  1.268],
       [ 0.192,  0.192,  0.192, ...,  1.268,  1.268,  1.268],
       [ 0.192,  0.192,  0.192, ...,  1.268,  1.268,  1.268]])
kinship_matrix.shape:  (1217, 1217)
run_other_old genotype_matrix:  (8000, 1217)
[[-2.262 -2.262 -2.262 ...,  0.442  0.442  0.442]
 [ 0.323  0.323  0.323 ...,  0.323  0.323  0.323]
 [-4.05  -4.05  -4.05  ...,  0.247  0.247  0.247]
 ..., 
 [-1.772 -1.772 -1.772 ..., -1.772 -1.772 -1.772]
 [-1.8   -1.8   -1.8   ...,  0.556  0.556  0.556]
 [-1.772 -1.772 -1.772 ..., -1.772 -1.772 -1.772]]
Starting benchmark: Doing GWAS
this K is: (1217, 1217) array([[ 1.435,  1.435,  1.435, ...,  0.192,  0.192,  0.192],
       [ 1.435,  1.435,  1.435, ...,  0.192,  0.192,  0.192],
       [ 1.435,  1.435,  1.435, ...,  0.192,  0.192,  0.192],
       ..., 
       [ 0.192,  0.192,  0.192, ...,  1.268,  1.268,  1.268],
       [ 0.192,  0.192,  0.192, ...,  1.268,  1.268,  1.268],
       [ 0.192,  0.192,  0.192, ...,  1.268,  1.268,  1.268]])
Kva (1217,) =
 [-0. -0. -0.]  ...  [ 130.341  197.893  245.413]
Kve (1217, 1217) =
[ [-0.157 -0.132  0.09 ]  ...  [-0.03  -0.067 -0.018] 
  [ 0.935  0.146 -0.037]  ...  [-0.03  -0.067 -0.018] 
  ...
  [ 0.002  0.001  0.002]  ...  [ 0.    -0.032  0.006] 
  [ 0.002  0.001  0.002]  ...  [ 0.    -0.032  0.006] ] strides:  (8, 9736) 

sum(Kva),sum(Kve)= 1201.964986 [ 0.165 -0.662 -0.147 ..., -0.     0.    -0.   ]
self.Kva is:  (1217,) array([   0.   ,    0.   ,    0.   , ...,  130.341,  197.893,  245.413])
self.Kve is:  (1217, 1217) array([[-0.157, -0.132,  0.09 , ..., -0.03 , -0.067, -0.018],
       [ 0.935,  0.146, -0.037, ..., -0.03 , -0.067, -0.018],
       [-0.044,  0.111,  0.081, ..., -0.03 , -0.067, -0.018],
       ..., 
       [ 0.002,  0.002,  0.001, ...,  0.   , -0.032,  0.006],
       [ 0.002,  0.001,  0.002, ...,  0.   , -0.032,  0.006],
       [ 0.002,  0.001,  0.002, ...,  0.   , -0.032,  0.006]])
  Doing GWAS took: 21.657857 seconds

Timing report

[33%] Calculate Kinship: 10.5478479862
[67%] Doing GWAS: 21.6578571796

[ 0.898  0.153  0.324 ...,  0.962  0.883  0.962]
8000 4070.02297939
