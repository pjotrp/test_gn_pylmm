sys.path2: ['/export/local/users/wrk/izip/git/opensource/python/gn2/wqflask/wqflask/my_pylmm/pyLMM', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/matplotlib_venn-0.9-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/googlecl-0.9.14-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/gdata-2.0.18-py2.7.egg', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/my_pylmm/pyLMM', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/lib', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/home/zas1024/gene/wqflask/']
WARNING: Standalone version missing the Genenetwork2 environment

Command:  redis
data/test8000.pheno
(1219,)
data/test8000.geno
(8000, 1219)
Original G (8000, 1219) 
[[ 0.  0.  0. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
Removed missing phenotypes (8000, 1217) 
[[ 0.  0.  0. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  1.  1.  1.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
Loading Redis from parsed data
kinship None
pheno [ 0.57832646  0.19578235 -0.52130538 ..., -0.05311412 -1.0516465
 -0.42998498]
geno (1217, 8000) [[ 0.  1.  0. ...,  0.  0.  0.]
 [ 0.  1.  0. ...,  0.  0.  0.]
 [ 0.  1.  0. ...,  0.  0.  0.]
 ..., 
 [ 1.  1.  1. ...,  0.  1.  0.]
 [ 1.  1.  1. ...,  0.  1.  0.]
 [ 1.  1.  1. ...,  0.  1.  0.]]
Running the original LMM engine in run_other (old)
REML= True  REFIT= False
Starting benchmark: Calculate Kinship
call genotype.normalize
call calculate_kinship_new
CPU cores: 4
8000 1000
  Calculate Kinship took: 7.087931 seconds
kinship_matrix:  array([[ 1.43484318,  1.43484318,  1.43484318, ...,  0.19234897,
         0.19234897,  0.19234897],
       [ 1.43484318,  1.43484318,  1.43484318, ...,  0.19234897,
         0.19234897,  0.19234897],
       [ 1.43484318,  1.43484318,  1.43484318, ...,  0.19234897,
         0.19234897,  0.19234897],
       ..., 
       [ 0.19234897,  0.19234897,  0.19234897, ...,  1.26798392,
         1.26798392,  1.26798392],
       [ 0.19234897,  0.19234897,  0.19234897, ...,  1.26798392,
         1.26798392,  1.26798392],
       [ 0.19234897,  0.19234897,  0.19234897, ...,  1.26798392,
         1.26798392,  1.26798392]])
kinship_matrix.shape:  (1217, 1217)
run_other_old genotype_matrix:  (1217, 8000)
[[-2.26208339  0.32268805 -4.05040703 ..., -1.77185095 -1.80011614
  -1.77185095]
 [-2.26208339  0.32268805 -4.05040703 ..., -1.77185095 -1.80011614
  -1.77185095]
 [-2.26208339  0.32268805 -4.05040703 ..., -1.77185095 -1.80011614
  -1.77185095]
 ..., 
 [ 0.44207035  0.32268805  0.24688877 ..., -1.77185095  0.55551971
  -1.77185095]
 [ 0.44207035  0.32268805  0.24688877 ..., -1.77185095  0.55551971
  -1.77185095]
 [ 0.44207035  0.32268805  0.24688877 ..., -1.77185095  0.55551971
  -1.77185095]]
Starting benchmark: Doing GWAS
this K is: (1217, 1217) array([[ 1.43484318,  1.43484318,  1.43484318, ...,  0.19234897,
         0.19234897,  0.19234897],
       [ 1.43484318,  1.43484318,  1.43484318, ...,  0.19234897,
         0.19234897,  0.19234897],
       [ 1.43484318,  1.43484318,  1.43484318, ...,  0.19234897,
         0.19234897,  0.19234897],
       ..., 
       [ 0.19234897,  0.19234897,  0.19234897, ...,  1.26798392,
         1.26798392,  1.26798392],
       [ 0.19234897,  0.19234897,  0.19234897, ...,  1.26798392,
         1.26798392,  1.26798392],
       [ 0.19234897,  0.19234897,  0.19234897, ...,  1.26798392,
         1.26798392,  1.26798392]])
('Kva is: ', (1217,), array([ -1.45555245e-12,  -3.20534023e-13,  -2.71456407e-13, ...,
         1.30341171e+02,   1.97893249e+02,   2.45412699e+02]))
('Kve is: ', (1217, 1217), array([[ -1.76450278e-01,  -2.20803904e-02,   1.30888387e-01, ...,
         -3.00708151e-02,  -6.70536051e-02,  -1.82151701e-02],
       [  9.52733007e-01,   1.21692767e-02,  -3.89916758e-02, ...,
         -3.00708151e-02,  -6.70536051e-02,  -1.82151701e-02],
       [ -2.49958168e-02,  -5.60836273e-01,   3.69255129e-01, ...,
         -3.00708151e-02,  -6.70536051e-02,  -1.82151701e-02],
       ..., 
       [  3.98558874e-03,  -1.32656030e-03,  -4.81353180e-03, ...,
          2.38511863e-04,  -3.19729670e-02,   6.15621903e-03],
       [  3.65840159e-03,  -5.53204774e-03,  -2.75575537e-03, ...,
          2.38511863e-04,  -3.19729670e-02,   6.15621903e-03],
       [  3.65840159e-03,  -5.53204774e-03,  -2.75575537e-03, ...,
          2.38511863e-04,  -3.19729670e-02,   6.15621903e-03]]))
sum(Kva),sum(Kve)= 1201.964986 [ -1.59685954e-01  -3.85291711e+00  -2.70438382e+00 ...,   2.78188930e-14
   1.08663079e-14   3.95170008e-15]
self.Kva is:  (1217,) array([  1.00000000e-06,   1.00000000e-06,   1.00000000e-06, ...,
         1.30341171e+02,   1.97893249e+02,   2.45412699e+02])
self.Kve is:  (1217, 1217) array([[ -1.76450278e-01,  -2.20803904e-02,   1.30888387e-01, ...,
         -3.00708151e-02,  -6.70536051e-02,  -1.82151701e-02],
       [  9.52733007e-01,   1.21692767e-02,  -3.89916758e-02, ...,
         -3.00708151e-02,  -6.70536051e-02,  -1.82151701e-02],
       [ -2.49958168e-02,  -5.60836273e-01,   3.69255129e-01, ...,
         -3.00708151e-02,  -6.70536051e-02,  -1.82151701e-02],
       ..., 
       [  3.98558874e-03,  -1.32656030e-03,  -4.81353180e-03, ...,
          2.38511863e-04,  -3.19729670e-02,   6.15621903e-03],
       [  3.65840159e-03,  -5.53204774e-03,  -2.75575537e-03, ...,
          2.38511863e-04,  -3.19729670e-02,   6.15621903e-03],
       [  3.65840159e-03,  -5.53204774e-03,  -2.75575537e-03, ...,
          2.38511863e-04,  -3.19729670e-02,   6.15621903e-03]])
  Doing GWAS took: 24.215449 seconds

Timing report

[23%] Calculate Kinship: 7.08793115616
[77%] Doing GWAS: 24.2154490948

[ 0.89840637  0.15251667  0.3244076  ...,  0.96206198  0.88271109
  0.96206198]
8000 4070.02329076
