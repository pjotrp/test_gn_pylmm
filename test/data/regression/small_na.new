sys.path2: ['/export/local/users/wrk/izip/git/opensource/python/gn2/wqflask/wqflask/my_pylmm/pyLMM', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/matplotlib_venn-0.9-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/googlecl-0.9.14-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/gdata-2.0.18-py2.7.egg', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/my_pylmm/pyLMM', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/lib', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/home/zas1024/gene/wqflask/']
Command:  redis
data/small.pheno
(4,)
data/small_na.geno
(6, 4)
Original G (6, 4) 
[[ 1.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 0.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 1.   1.   1.   0. ]
 [ 1.   1.   nan  0. ]]
Removed missing phenotypes (6, 4) 
[[ 1.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 0.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 1.   1.   1.   0. ]
 [ 1.   1.   nan  0. ]]
Loading Redis from parsed data
kinship None
pheno [ 0.578  0.196 -0.521 -1.912]
geno (4, 6) [[ 1.   1.   0.   1.   1.   1. ]
 [ 1.   1.   1.   1.   1.   1. ]
 [ 0.5  0.   0.5  0.   1.   nan]
 [ 0.   0.   0.   0.   0.   0. ]]
Running the original LMM engine in run_other (old)
REML= True  REFIT= False
Starting benchmark: Calculate Kinship
G (6, 4) =
[ [ 0.905  0.905 -0.302]  ...  [ 0.905 -0.302 -1.508] 
  [ 1.  1. -1.]  ...  [ 1. -1. -1.] 
  ...
  [ 0.577  0.577  0.577]  ...  [ 0.577  0.577 -1.732] 
  [ 0.707  0.707  0.   ]  ...  [ 0.707  0.    -1.414] ]
  Calculate Kinship took: 0.013209 seconds
kinship_matrix:  array([[ 0.745,  0.381, -0.369, -0.758],
       [ 0.381,  0.987, -0.247, -1.121],
       [-0.369, -0.247,  0.419,  0.197],
       [-0.758, -1.121,  0.197,  1.682]])
kinship_matrix.shape:  (4, 4)
run_other_old genotype_matrix:  (4, 6)
[[ 0.905  1.    -0.905  1.     0.577  0.707]
 [ 0.905  1.     1.508  1.     0.577  0.707]
 [-0.302 -1.     0.302 -1.     0.577  0.   ]
 [-1.508 -1.    -0.905 -1.    -1.732 -1.414]]
Starting benchmark: Doing GWAS
this K is: (4, 4) array([[ 0.745,  0.381, -0.369, -0.758],
       [ 0.381,  0.987, -0.247, -1.121],
       [-0.369, -0.247,  0.419,  0.197],
       [-0.758, -1.121,  0.197,  1.682]])
Kva (4,) =
 [ 0.     0.308  0.612]  ...  [ 0.308  0.612  2.914]
Kve (4, 4) =
[ [ 0.5   -0.391  0.673]  ...  [-0.391  0.673 -0.38 ] 
  [ 0.5    0.61  -0.316]  ...  [ 0.61  -0.316 -0.528] 
  ...
  [ 0.5   -0.585 -0.617]  ...  [-0.585 -0.617  0.167] 
  [ 0.5    0.366  0.259]  ...  [ 0.366  0.259  0.741] ]
sum(Kva),sum(Kve)= 3.83333333333 [ 2.  0.  0.  0.]
self.Kva is:  (4,) array([ 0.   ,  0.308,  0.612,  2.914])
self.Kve is:  (4, 4) array([[ 0.5  , -0.391,  0.673, -0.38 ],
       [ 0.5  ,  0.61 , -0.316, -0.528],
       [ 0.5  , -0.585, -0.617,  0.167],
       [ 0.5  ,  0.366,  0.259,  0.741]])
  Doing GWAS took: 0.023473 seconds

Timing report

[36%] Calculate Kinship: 0.0132088661194
[64%] Doing GWAS: 0.0234730243683

[ 0.09   0.724  0.733  0.724  0.179  0.041]
6 2.48911996242
