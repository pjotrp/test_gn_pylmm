sys.path2: ['/export/local/users/wrk/izip/git/opensource/python/gn2/wqflask/wqflask/my_pylmm/pyLMM', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/matplotlib_venn-0.9-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/googlecl-0.9.14-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/gdata-2.0.18-py2.7.egg', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/my_pylmm/pyLMM', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/lib', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/home/zas1024/gene/wqflask/', '/home/danny/GeneNetwork/wqflask/wqflask/my_pylmm/pyLMM/']
Command:  redis
data/small_na.pheno
(4,)
data/small_na.geno
(6, 4)
Original G (6, 4) 
[[ 1.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 0.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 1.   1.   1.   0. ]
 [ 1.   1.   nan  0. ]]
Removed missing phenotypes (6, 3) 
[[ 1.   0.5  0. ]
 [ 1.   0.   0. ]
 [ 0.   0.5  0. ]
 [ 1.   0.   0. ]
 [ 1.   1.   0. ]
 [ 1.   nan  0. ]]
kinship_matrix
genotype_matrix
pheno_vector
covariate_matrix
pheno [ 0.578 -0.521 -1.912]
geno (6, 3) [[ 1.   0.5  0. ]
 [ 1.   0.   0. ]
 [ 0.   0.5  0. ]
 [ 1.   0.   0. ]
 [ 1.   1.   0. ]
 [ 1.   nan  0. ]]
Running the original LMM engine in run_other (old)
REML= True  REFIT= False
Starting benchmark: Calculate Kinship
G (6, 3) =
[ [ 1.   0.5  0. ]  ...  [ 1.   0.5  0. ] 
  [ 1.  0.  0.]  ...  [ 1.  0.  0.] 
  ...
  [ 1.  1.  0.]  ...  [ 1.  1.  0.] 
  [  1.  nan   0.]  ...  [  1.  nan   0.] ]
G (6, 3) =
[ [ 1.225  0.    -1.225]  ...  [ 1.225  0.    -1.225] 
  [ 1.414 -0.707 -0.707]  ...  [ 1.414 -0.707 -0.707] 
  ...
  [ 0.707  0.707 -1.414]  ...  [ 0.707  0.707 -1.414] 
  [ 1.  0. -1.]  ...  [ 1.  0. -1.] ]
  Calculate Kinship took: 0.016761 seconds
kinship_matrix:  array([[ 1.25 , -0.417, -0.833],
       [-0.417,  0.583, -0.167],
       [-0.833, -0.167,  1.   ]])
kinship_matrix.shape:  (3, 3)
run_other_old genotype_matrix:  (6, 3)
[[ 1.225  0.    -1.225]
 [ 1.414 -0.707 -0.707]
 [-0.707  1.414 -0.707]
 [ 1.414 -0.707 -0.707]
 [ 0.707  0.707 -1.414]
 [ 1.     0.    -1.   ]]
Starting benchmark: Doing GWAS
this K is: (3, 3) array([[ 1.25 , -0.417, -0.833],
       [-0.417,  0.583, -0.167],
       [-0.833, -0.167,  1.   ]])
Kva (3,) =
 [ 0.     0.833  2.   ]  ...  [ 0.     0.833  2.   ]
Kve (3, 3) =
[ [-0.577  0.267  0.772]  ...  [-0.577  0.267  0.772] 
  [-0.577 -0.802 -0.154]  ...  [-0.577 -0.802 -0.154] 
  ...
  [-0.577 -0.802 -0.154]  ...  [-0.577 -0.802 -0.154] 
  [-0.577  0.535 -0.617]  ...  [-0.577  0.535 -0.617] ]
sum(Kva),sum(Kve)= 2.83333333333 [-1.732 -0.     0.   ]
self.Kva is:  (3,) array([ 0.   ,  0.833,  2.   ])
self.Kve is:  (3, 3) array([[-0.577,  0.267,  0.772],
       [-0.577, -0.802, -0.154],
       [-0.577,  0.535, -0.617]])
  Doing GWAS took: 0.023437 seconds

Timing report

[42%] Calculate Kinship: 0.0167608261108
[58%] Doing GWAS: 0.0234370231628

[ 0.062  0.558  0.833  0.558  0.345  0.062]
6 2.41940200508
