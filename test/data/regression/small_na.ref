sys.path2: ['/export/local/users/wrk/izip/git/opensource/python/gn2/wqflask/wqflask/my_pylmm/pyLMM', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/matplotlib_venn-0.9-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/googlecl-0.9.14-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/gdata-2.0.18-py2.7.egg', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/my_pylmm/pyLMM', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/lib', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/home/zas1024/gene/wqflask/']
WARNING: Standalone version missing the Genenetwork2 environment

Command:  redis
data/small.pheno
(4,)
data/small_na.geno
(6, 4)
Original G (6, 4) 
[[ 1.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 0.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 1.   1.   1.   0. ]
 [ 1.   1.   nan  0. ]]
Removed missing phenotypes (6, 4) 
[[ 1.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 0.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 1.   1.   1.   0. ]
 [ 1.   1.   nan  0. ]]
Loading Redis from parsed data
kinship None
pheno [ 0.57832646  0.19578235 -0.52130538 -1.91220117]
geno (4, 6) [[ 0.90453403  1.         -0.90453403  1.          0.57735027  0.70710678]
 [ 0.90453403  1.          1.50755672  1.          0.57735027  0.70710678]
 [-0.30151134 -1.          0.30151134 -1.          0.57735027  0.        ]
 [-1.50755672 -1.         -0.90453403 -1.         -1.73205081 -1.41421356]]
Running the original LMM engine in run_other (old)
REML= True  REFIT= False
Starting benchmark: Calculate Kinship
CPU cores: 4
6 1000
  Calculate Kinship took: 0.008083 seconds
kinship_matrix:  array([[ 0.77272727,  0.40909091, -0.36868687, -0.81313131],
       [ 0.40909091,  1.01515152, -0.24747475, -1.17676768],
       [-0.36868687, -0.24747475,  0.41919192,  0.1969697 ],
       [-0.81313131, -1.17676768,  0.1969697 ,  1.79292929]])
kinship_matrix.shape:  (4, 4)
genotype_matrix:  (4, 6)
[[  9.04534034e-01   1.00000000e+00  -9.04534034e-01   1.00000000e+00
    5.77350269e-01   8.16496581e-01]
 [  9.04534034e-01   1.00000000e+00   1.50755672e+00   1.00000000e+00
    5.77350269e-01   8.16496581e-01]
 [ -3.01511345e-01  -1.00000000e+00   3.01511345e-01  -1.00000000e+00
    5.77350269e-01  -6.40987562e-17]
 [ -1.50755672e+00  -1.00000000e+00  -9.04534034e-01  -1.00000000e+00
   -1.73205081e+00  -1.63299316e+00]]
Starting benchmark: Doing GWAS
this K is: (4, 4) array([[ 0.77272727,  0.40909091, -0.36868687, -0.81313131],
       [ 0.40909091,  1.01515152, -0.24747475, -1.17676768],
       [-0.36868687, -0.24747475,  0.41919192,  0.1969697 ],
       [-0.81313131, -1.17676768,  0.1969697 ,  1.79292929]])
('Kva is: ', (4,), array([ -4.45503077e-17,   3.14448864e-01,   6.12731371e-01,
         3.07281976e+00]))
('Kve is: ', (4, 4), array([[-0.5       , -0.39095771,  0.67180027, -0.38188542],
       [-0.5       ,  0.61838713, -0.30884427, -0.52173995],
       [-0.5       , -0.58216287, -0.62160928,  0.1571251 ],
       [-0.5       ,  0.35473345,  0.25865329,  0.74650027]]))
sum(Kva),sum(Kve)= 4.000001 [ -2.00000000e+00  -1.72084569e-15   1.49880108e-15   3.33066907e-16]
self.Kva is:  (4,) array([  1.00000000e-06,   3.14448864e-01,   6.12731371e-01,
         3.07281976e+00])
self.Kve is:  (4, 4) array([[-0.5       , -0.39095771,  0.67180027, -0.38188542],
       [-0.5       ,  0.61838713, -0.30884427, -0.52173995],
       [-0.5       , -0.58216287, -0.62160928,  0.1571251 ],
       [-0.5       ,  0.35473345,  0.25865329,  0.74650027]])
  Doing GWAS took: 0.024282 seconds

Timing report

[25%] Calculate Kinship: 0.00808310508728
[75%] Doing GWAS: 0.0242819786072

[ 0.09577906  0.72935275  0.72319869  0.72935275  0.1901278   0.04349858]
2.51130962544
