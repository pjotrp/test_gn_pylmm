sys.path2: ['/export/local/users/wrk/izip/git/opensource/python/gn2/wqflask/wqflask/my_pylmm/pyLMM', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/matplotlib_venn-0.9-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/googlecl-0.9.14-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/gdata-2.0.18-py2.7.egg', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/my_pylmm/pyLMM', '/export/local/users/wrk/izip/git/opensource/python/test_gn_pylmm/lib', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/home/zas1024/gene/wqflask/']
WARNING: Standalone version missing the Genenetwork2 environment

Command:  redis_new
data/small.pheno
(4,)
data/small_na.geno
(6, 4)
Original G (6, 4) 
[[ 1.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 0.   1.   0.5  0. ]
 [ 1.   1.   0.   0. ]
 [ 1.   1.   1.   0. ]
 [ 1.   1.   nan  0. ]]
Loading Redis from parsed data
kinship None
pheno [ 0.57832646  0.19578235 -0.52130538 -1.91220117]
geno (4, 6) [[ 1.   1.   0.   1.   1.   1. ]
 [ 1.   1.   1.   1.   1.   1. ]
 [ 0.5  0.   0.5  0.   1.   nan]
 [ 0.   0.   0.   0.   0.   0. ]]
Running the new LMM2 engine in run_other_new
REML= True  REFIT= False
Removed missing phenotypes (4,)
Starting benchmark: Calculate Kinship
call genotype.normalize
call calculate_kinship_new
CPU cores: 4
6 1000
  Calculate Kinship took: 0.008583 seconds
kinship_matrix:  array([[ 0.74494949,  0.38131313, -0.36868687, -0.75757576],
       [ 0.38131313,  0.98737374, -0.24747475, -1.12121212],
       [-0.36868687, -0.24747475,  0.41919192,  0.1969697 ],
       [-0.75757576, -1.12121212,  0.1969697 ,  1.68181818]])
kinship_matrix.shape:  (4, 4)
run_other_new genotype_matrix:  (4, 6)
[[ 0.90453403  1.         -0.90453403  1.          0.57735027  0.70710678]
 [ 0.90453403  1.          1.50755672  1.          0.57735027  0.70710678]
 [-0.30151134 -1.          0.30151134 -1.          0.57735027  0.        ]
 [-1.50755672 -1.         -0.90453403 -1.         -1.73205081 -1.41421356]]
Starting benchmark: Doing GWAS
('this K is:', (4, 4), array([[ 0.74494949,  0.38131313, -0.36868687, -0.75757576],
       [ 0.38131313,  0.98737374, -0.24747475, -1.12121212],
       [-0.36868687, -0.24747475,  0.41919192,  0.1969697 ],
       [-0.75757576, -1.12121212,  0.1969697 ,  1.68181818]]))
('Kva is: ', (4,), array([  3.56878961e-16,   3.07583398e-01,   6.12039748e-01,
         2.91371019e+00]))
('Kve is: ', (4, 4), array([[ 0.5       , -0.39079201,  0.67294718, -0.38003119],
       [ 0.5       ,  0.6096595 , -0.31559815, -0.52793285],
       [ 0.5       , -0.58464181, -0.61667608,  0.16704662],
       [ 0.5       ,  0.36577432,  0.25932705,  0.74091742]]))
('sum(Kva),sum(Kve)=', 3.8333343333333287, array([  2.00000000e+00,   9.43689571e-16,   1.16573418e-15,
         0.00000000e+00]))
Running on 1 THREAD
count= 6  running= 0  collect= 0
res= [(3.1105934055388609, 0.089667423112266748), (0.40668673511799042, 0.72362959646939684), (-0.39157419672234489, 0.73315520576967841), (0.40668673511799042, 0.72362959646939684), (2.0373637210728481, 0.17851248468808281), (4.8151913165666036, 0.040525655909206711)]
[6]
  Doing GWAS took: 0.028218 seconds

Timing report

[23%] Calculate Kinship: 0.00858306884766
[77%] Doing GWAS: 0.0282180309296

[ 0.08966742  0.7236296   0.73315521  0.7236296   0.17851248  0.04052566]
6 2.48911996242
